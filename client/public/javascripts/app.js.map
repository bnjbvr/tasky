{"version":3,"file":"public/javascripts/app.js","sources":["app/application.coffee","app/collections/archived_tasks.coffee","app/collections/tags.coffee","app/collections/tasks.coffee","app/initialize.coffee","app/lib/base_view.coffee","app/lib/utils.coffee","app/lib/view_collection.coffee","app/locales/en.coffee","app/locales/fr.coffee","app/models/task.coffee","app/router.coffee","app/views/app_view.coffee","app/views/archive_list_view.coffee","app/views/archive_task_view.coffee","app/views/menu_item_view.coffee","app/views/menu_view.coffee","app/views/task_form_view.coffee","app/views/task_list_view.coffee","app/views/task_view.coffee","app/views/templates/home.jade","app/views/templates/menu.jade","app/views/templates/menu_item.jade","app/views/templates/task.jade","app/views/templates/task_archive.jade","app/views/templates/task_form.jade","app/views/templates/task_list.jade","app/views/templates/task_list_archive.jade"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3BA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/DA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtFA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvEA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7CA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9GA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjEA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzGA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtHA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7DA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArIA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3JA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7GA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApWA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1JA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A","sourcesContent":["module.exports = {\n  initialize: function() {\n    var Router, e, locales;\n\n    this.locale = window.locale;\n    delete window.locale;\n    this.polyglot = new Polyglot({\n      locale: this.locale\n    });\n    try {\n      locales = require('locales/' + this.locale);\n    } catch (_error) {\n      e = _error;\n      locales = require('locales/en');\n    }\n    this.polyglot.extend(locales);\n    window.t = this.polyglot.t.bind(this.polyglot);\n    Router = require('router');\n    this.router = new Router();\n    Backbone.history.start();\n    if (typeof Object.freeze === 'function') {\n      return Object.freeze(this);\n    }\n  }\n};\n","var ArchivedTaskCollection, TaskCollection, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nTaskCollection = require('./tasks');\n\nmodule.exports = ArchivedTaskCollection = (function(_super) {\n  __extends(ArchivedTaskCollection, _super);\n\n  function ArchivedTaskCollection() {\n    _ref = ArchivedTaskCollection.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  ArchivedTaskCollection.prototype.comparator = function(a, b) {\n    if (a.get('completionDate') > b.get('completionDate')) {\n      return -1;\n    } else if (a.get('completionDate') === b.get('completionDate')) {\n      return 0;\n    } else {\n      return 1;\n    }\n  };\n\n  return ArchivedTaskCollection;\n\n})(TaskCollection);\n","var TagsCollection, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = TagsCollection = (function(_super) {\n  __extends(TagsCollection, _super);\n\n  function TagsCollection() {\n    _ref = TagsCollection.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  TagsCollection.prototype.comparator = function(a, b) {\n    if (a.get('count') > b.get('count')) {\n      return -1;\n    } else if (a.get('count') === b.get('count')) {\n      if (a.get('id') < b.get('id')) {\n        return -1;\n      } else if (a.get('id') > b.get('id')) {\n        return 1;\n      } else {\n        return 0;\n      }\n    } else {\n      return 1;\n    }\n  };\n\n  TagsCollection.extractFromTasks = function(taskCollection, excludes, selectedTags) {\n    var tagsList;\n\n    if (excludes == null) {\n      excludes = [];\n    }\n    if (selectedTags == null) {\n      selectedTags = [];\n    }\n    tagsList = new TagsCollection();\n    taskCollection.pluck('tags').forEach(function(tagsOfTask) {\n      return tagsOfTask.forEach(function(tag) {\n        var tagInfo;\n\n        tag = tag.toLowerCase();\n        if (!_.contains(excludes, tag)) {\n          if (tagsList.get(tag) == null) {\n            tagsList.add(new Backbone.Model({\n              id: tag,\n              count: 0,\n              selectIndex: selectedTags.indexOf(tag)\n            }));\n          }\n          tagInfo = tagsList.get(tag);\n          return tagInfo.set('count', tagInfo.get('count') + 1);\n        }\n      });\n    });\n    tagsList.sort();\n    return tagsList;\n  };\n\n  return TagsCollection;\n\n})(Backbone.Collection);\n","var TagsCollection, Task, TaskCollection, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nTagsCollection = require('./tags');\n\nTask = require('../models/task');\n\nmodule.exports = TaskCollection = (function(_super) {\n  __extends(TaskCollection, _super);\n\n  function TaskCollection() {\n    _ref = TaskCollection.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  TaskCollection.prototype.url = 'tasks';\n\n  TaskCollection.prototype.model = Task;\n\n  TaskCollection.prototype.comparator = function(a, b) {\n    if (a.get('order') < b.get('order')) {\n      return -1;\n    } else if (a.get('order') === b.get('order')) {\n      return 0;\n    } else {\n      return 1;\n    }\n  };\n\n  TaskCollection.prototype.getNewOrder = function(prev, next) {\n    var lowBoundary, order, step, topBoundary;\n\n    topBoundary = next != null ? next.get('order') : Number.MAX_VALUE;\n    lowBoundary = prev != null ? prev.get('order') : 0.0;\n    step = (topBoundary - lowBoundary) / 2;\n    order = lowBoundary + step;\n    return {\n      order: order,\n      step: step\n    };\n  };\n\n  TaskCollection.prototype.getAllTags = function() {\n    return TagsCollection.extractFromTasks(this);\n  };\n\n  TaskCollection.prototype.getByTags = function(tags) {\n    if (tags === void 0 || tags === null) {\n      return this;\n    }\n    if (tags.length === 0) {\n      return new BackboneProjections.Filtered(this, {\n        filter: function(task) {\n          return task.get('tags').length === 0;\n        }\n      });\n    }\n    return new BackboneProjections.Filtered(this, {\n      filter: function(task) {\n        return task.containsTags(tags);\n      }\n    });\n  };\n\n  TaskCollection.prototype.reindex = function() {\n    var _this = this;\n\n    this.trigger('reindexing');\n    return $.ajax('tasks/reindex', {\n      method: 'POST',\n      success: function(data) {\n        data.forEach(function(task) {\n          return _this.get(task.id).set('order', task.order);\n        });\n        return _this.trigger('reindexed');\n      },\n      error: function(data) {\n        return this.trigger('reindexed', data);\n      }\n    });\n  };\n\n  return TaskCollection;\n\n})(Backbone.Collection);\n","var app;\n\napp = require('application');\n\n$(function() {\n  $.fn.spin = function(opts, color) {\n    var presets;\n\n    presets = {\n      tiny: {\n        lines: 8,\n        length: 2,\n        width: 2,\n        radius: 3\n      },\n      small: {\n        lines: 8,\n        length: 1,\n        width: 2,\n        radius: 4\n      },\n      medium: {\n        lines: 10,\n        length: 4,\n        width: 3,\n        radius: 6\n      },\n      large: {\n        lines: 10,\n        length: 8,\n        width: 4,\n        radius: 8\n      },\n      extralarge: {\n        lines: 8,\n        length: 3,\n        width: 10,\n        radius: 20,\n        top: 30,\n        left: 50\n      }\n    };\n    if (typeof Spinner !== \"undefined\" && Spinner !== null) {\n      return this.each(function() {\n        var $this, spinner;\n\n        $this = $(this);\n        spinner = $this.data(\"spinner\");\n        if (spinner != null) {\n          spinner.stop();\n          return $this.data(\"spinner\", null);\n        } else if (opts !== false) {\n          if (typeof opts === \"string\") {\n            if (opts in presets) {\n              opts = presets[opts];\n            } else {\n              opts = {};\n            }\n            if (color) {\n              opts.color = color;\n            }\n          }\n          spinner = new Spinner(opts);\n          spinner.spin(this);\n          return $this.data(\"spinner\", spinner);\n        }\n      });\n    }\n  };\n  return app.initialize();\n});\n","var BaseView, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = BaseView = (function(_super) {\n  __extends(BaseView, _super);\n\n  function BaseView() {\n    _ref = BaseView.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  BaseView.prototype.template = function() {};\n\n  BaseView.prototype.initialize = function() {};\n\n  BaseView.prototype.getRenderData = function() {\n    var _ref1;\n\n    return {\n      model: (_ref1 = this.model) != null ? _ref1.toJSON() : void 0\n    };\n  };\n\n  BaseView.prototype.render = function() {\n    this.beforeRender();\n    this.$el.html(this.template(this.getRenderData()));\n    this.afterRender();\n    return this;\n  };\n\n  BaseView.prototype.beforeRender = function() {};\n\n  BaseView.prototype.afterRender = function() {};\n\n  BaseView.prototype.destroy = function() {\n    this.undelegateEvents();\n    this.$el.removeData().unbind();\n    this.remove();\n    return Backbone.View.prototype.remove.call(this);\n  };\n\n  return BaseView;\n\n})(Backbone.View);\n","module.exports.buildTagsList = function(tags, options) {\n  var lastSeparator, regularSeparator, tagPrefix, tagsList;\n\n  if (options == null) {\n    options = {};\n  }\n  tagPrefix = options.tagPrefix || '';\n  regularSeparator = options.regularSeparator || ' ';\n  lastSeparator = options.lastSeparator || ' ';\n  if (tags == null) {\n    return \"\";\n  }\n  tagsList = \"\";\n  tags.forEach(function(tag) {\n    if (tags.indexOf(tag) === 0) {\n      return tagsList = \"\" + tagPrefix + tag;\n    } else if (tags.indexOf(tag) === (tags.length - 1)) {\n      return tagsList = \"\" + tagsList + lastSeparator + tagPrefix + tag;\n    } else {\n      return tagsList = \"\" + tagsList + regularSeparator + tagPrefix + tag;\n    }\n  });\n  return tagsList;\n};\n","var BaseView, ViewCollection, _ref,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('lib/base_view');\n\nmodule.exports = ViewCollection = (function(_super) {\n  __extends(ViewCollection, _super);\n\n  function ViewCollection() {\n    this.removeItem = __bind(this.removeItem, this);\n    this.addItem = __bind(this.addItem, this);    _ref = ViewCollection.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  ViewCollection.prototype.itemview = null;\n\n  ViewCollection.prototype.views = {};\n\n  ViewCollection.prototype.template = function() {\n    return '';\n  };\n\n  ViewCollection.prototype.itemViewOptions = function() {};\n\n  ViewCollection.prototype.collectionEl = null;\n\n  ViewCollection.prototype.onChange = function() {\n    return this.$el.toggleClass('empty', _.size(this.views) === 0);\n  };\n\n  ViewCollection.prototype.appendView = function(view) {\n    return this.$collectionEl.append(view.el);\n  };\n\n  ViewCollection.prototype.initialize = function() {\n    var collectionEl;\n\n    ViewCollection.__super__.initialize.apply(this, arguments);\n    this.views = {};\n    this.listenTo(this.collection, \"reset\", this.onReset);\n    this.listenTo(this.collection, \"add\", this.addItem);\n    this.listenTo(this.collection, \"remove\", this.removeItem);\n    if (this.collectionEl == null) {\n      return collectionEl = el;\n    }\n  };\n\n  ViewCollection.prototype.render = function() {\n    var id, view, _ref1;\n\n    _ref1 = this.views;\n    for (id in _ref1) {\n      view = _ref1[id];\n      view.$el.detach();\n    }\n    return ViewCollection.__super__.render.apply(this, arguments);\n  };\n\n  ViewCollection.prototype.afterRender = function() {\n    var id, view, _ref1;\n\n    this.$collectionEl = $(this.collectionEl);\n    _ref1 = this.views;\n    for (id in _ref1) {\n      view = _ref1[id];\n      this.appendView(view.$el);\n    }\n    this.onReset(this.collection);\n    return this.onChange(this.views);\n  };\n\n  ViewCollection.prototype.remove = function() {\n    this.onReset([]);\n    return ViewCollection.__super__.remove.apply(this, arguments);\n  };\n\n  ViewCollection.prototype.onReset = function(newcollection) {\n    var id, view, _ref1;\n\n    _ref1 = this.views;\n    for (id in _ref1) {\n      view = _ref1[id];\n      view.remove();\n    }\n    return newcollection.forEach(this.addItem);\n  };\n\n  ViewCollection.prototype.addItem = function(model) {\n    var options, view;\n\n    options = _.extend({}, {\n      model: model\n    }, this.itemViewOptions(model));\n    view = new this.itemView(options);\n    this.views[model.cid] = view.render();\n    this.appendView(view);\n    return this.onChange(this.views);\n  };\n\n  ViewCollection.prototype.removeItem = function(model) {\n    this.views[model.cid].remove();\n    delete this.views[model.cid];\n    return this.onChange(this.views);\n  };\n\n  return ViewCollection;\n\n})(BaseView);\n","module.exports = {\n  \"todo\": \"To-do\",\n  \"archived\": \"Archived\",\n  \"untagged\": \"untagged\",\n  \"all tasks\": \"All tasks\",\n  \"all archived tasks\": \"All archived tasks\",\n  \"untagged tasks\": \"Untagged tasks\",\n  \"tasks of\": \"Tasks related to %{tagsList}\",\n  \"archived tasks of\": \"Archived tasks related to %{tagsList}\",\n  \"and\": \"and\",\n  \"archived date format\": \"{yyyy}/{MM}{dd} at {HH}:{mm}\",\n  \"actions headline\": \"Actions\",\n  \"completed headline\": \"Completed on\",\n  \"restore button\": \"Restore\",\n  \"restore button?\": \"Restore?\",\n  \"done button\": \"Done\",\n  \"done button?\": \"Done?\",\n  \"todo button\": \"Todo\",\n  \"todo button?\": \"Todo?\",\n  \"new button\": \"New\",\n  \"archive button\": \"Archive all done tasks\",\n  \"form headline tags\": \"What's next about %{tagsList}?\",\n  \"form headline\": \"What's next?\",\n  \"reindexing message\": \"Server is reindexing all the tasks, please wait a little...\"\n};\n","module.exports = {\n  \"todo\": \"A faire\",\n  \"archived\": \"Archivées\",\n  \"untagged\": \"sans étiquette\",\n  \"all tasks\": \"Toutes les tâches\",\n  \"all archived tasks\": \"Toutes les tâches archivées\",\n  \"untagged tasks\": \"Tâches sans étiquettes\",\n  \"tasks of\": \"Tâches correspondant à l'étiquette %{tagsList} |||| Tâches correspondant aux étiquettes %{tagsList}\",\n  \"archived tasks of\": \"Tâches archivées correspondant à l'étiquette %{tagsList} |||| Tâches archivées correspondant aux étiquettes %{tagsList}\",\n  \"and\": \"et\",\n  \"archived date format\": \"{dd}/{MM}/{yyyy} à {HH}h{mm}\",\n  \"actions headline\": \"Actions\",\n  \"completed headline\": \"Complétée le\",\n  \"restore button\": \"Restaurer\",\n  \"restore button?\": \"Restaurer ?\",\n  \"done button\": \"Fait\",\n  \"done button?\": \"Fait ?\",\n  \"todo button\": \"A faire\",\n  \"todo button?\": \"A faire ?\",\n  \"new button\": \"Ajouter\",\n  \"archive button\": \"Archiver toutes les tâches faites\",\n  \"form headline tags\": \"Que devez-vous faire à propos de %{tagsList} ?\",\n  \"form headline\": \"Que devez-vous faire ?\",\n  \"reindexing message\": \"Le serveur est en train de ré-indexer les tâches, merci de patienter...\"\n};\n","var Task, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = Task = (function(_super) {\n  __extends(Task, _super);\n\n  function Task() {\n    _ref = Task.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  Task.prototype.set = function(attributes, options) {\n    var tags;\n\n    Task.__super__.set.call(this, attributes, options);\n    if (attributes === \"description\") {\n      tags = Task.extractTags(this.get('description'));\n      return this.set('tags', tags);\n    }\n  };\n\n  Task.prototype.containsTags = function(tags) {\n    if (!(tags instanceof Array)) {\n      tags = [tags];\n    }\n    if (tags.length === 0) {\n      return this.get('tags').length === 0;\n    } else {\n      return _.every(tags, _.partial(_.contains, this.get('tags')));\n    }\n  };\n\n  Task.prototype.getPreviousWithTags = function(tags) {\n    var nextIndex, nextTask, order, subCollection;\n\n    order = this.get('order');\n    subCollection = this.collection.getByTags(tags);\n    nextTask = subCollection.find(function(task) {\n      return ((tags != null) && task.get('order') > order && task.containsTags(tags)) || ((tags == null) && task.get('order') > order);\n    });\n    nextIndex = subCollection.indexOf(nextTask);\n    if (nextIndex === -1) {\n      return _.last(subCollection.toArray());\n    } else {\n      return subCollection.at(nextIndex - 1);\n    }\n  };\n\n  Task.regex = /#([\\w\\d\\-_\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+)/g;\n\n  Task.extractTags = function(desc) {\n    var tags;\n\n    tags = desc.match(Task.regex);\n    tags = _.unique(tags);\n    tags = _.map(tags, function(tag) {\n      return tag.replace('#', '');\n    });\n    return tags;\n  };\n\n  return Task;\n\n})(Backbone.Model);\n","var AppView, ArchivedTaskCollection, ArchivedTaskListView, MenuView, Router, Task, TaskCollection, TaskListView, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nAppView = require('views/app_view');\n\nMenuView = require('views/menu_view');\n\nTaskListView = require('views/task_list_view');\n\nArchivedTaskListView = require('views/archive_list_view');\n\nTaskCollection = require('collections/tasks');\n\nArchivedTaskCollection = require('collections/archived_tasks');\n\nTask = require('models/task');\n\nmodule.exports = Router = (function(_super) {\n  __extends(Router, _super);\n\n  function Router() {\n    _ref = Router.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  Router.prototype.routes = {\n    '': 'main',\n    'archived': 'archived',\n    'todoByTags/*tags': 'todoByTags',\n    'archivedByTags/*tags': 'archivedByTags'\n  };\n\n  Router.prototype.initialize = function() {\n    var _this = this;\n\n    this.collection = new TaskCollection(initTasks);\n    this.archivedCollection = new ArchivedTaskCollection(archivedTasks);\n    this.mainView = new AppView();\n    this.mainView.render();\n    this.menu = new MenuView({\n      baseCollection: this.collection,\n      archivedCollection: this.archivedCollection\n    });\n    this.taskList = new TaskListView({\n      baseCollection: this.collection\n    });\n    this.listenTo(this.taskList, 'archive-tasks', function(tasks) {\n      _this.collection.remove(tasks);\n      _this.archivedCollection.add(tasks);\n      return _this.taskList.render();\n    });\n    this.archivedTaskList = new ArchivedTaskListView({\n      baseCollection: this.archivedCollection\n    });\n    return this.listenTo(this.archivedTaskList, 'restore-task', function(task) {\n      _this.archivedCollection.remove(task);\n      _this.collection.add(task);\n      return _this.archivedTaskList.render();\n    });\n  };\n\n  Router.prototype.main = function() {\n    this.taskList.setTags(null);\n    this.taskList.render();\n    this.menu.setViewType('#tobedone');\n    this.menu.setActive(null);\n    return this.menu.render();\n  };\n\n  Router.prototype.archived = function() {\n    this.archivedTaskList.setTags(null);\n    this.archivedTaskList.render();\n    this.menu.setViewType('#archived');\n    this.menu.setActive(null);\n    return this.menu.render();\n  };\n\n  Router.prototype.byTags = function(viewType, listView, tags) {\n    if (tags != null) {\n      tags = tags.split('/');\n      if (tags[tags.length - 1].length === 0) {\n        delete tags[tags.length - 1];\n      }\n    } else {\n      tags = [];\n    }\n    listView.setTags(tags);\n    listView.render();\n    this.menu.setViewType(viewType);\n    this.menu.setActive(tags);\n    return this.menu.render();\n  };\n\n  Router.prototype.todoByTags = function(tags) {\n    return this.byTags('#tobedone', this.taskList, tags);\n  };\n\n  Router.prototype.archivedByTags = function(tags) {\n    return this.byTags('#archived', this.archivedTaskList, tags);\n  };\n\n  return Router;\n\n})(Backbone.Router);\n","var AppView, BaseView, MenuView, TaskListView, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('../lib/base_view');\n\nMenuView = require('./menu_view');\n\nTaskListView = require('./task_list_view');\n\nmodule.exports = AppView = (function(_super) {\n  __extends(AppView, _super);\n\n  function AppView() {\n    _ref = AppView.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  AppView.prototype.el = 'body';\n\n  AppView.prototype.template = require('./templates/home');\n\n  return AppView;\n\n})(BaseView);\n","var ArchiveListView, ArchiveTaskView, BaseView, Task, TaskFormView, Utils,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('../lib/base_view');\n\nUtils = require('../lib/utils');\n\nTask = require('../models/task');\n\nArchiveTaskView = require('./archive_task_view');\n\nTaskFormView = require('./task_form_view');\n\nmodule.exports = ArchiveListView = (function(_super) {\n  __extends(ArchiveListView, _super);\n\n  ArchiveListView.prototype.el = '.container';\n\n  ArchiveListView.prototype.template = require('./templates/task_list_archive');\n\n  ArchiveListView.prototype.views = null;\n\n  ArchiveListView.prototype.collectionEl = 'ul#task-list';\n\n  function ArchiveListView(options) {\n    this.baseCollection = options.baseCollection;\n    this.views = new Backbone.ChildViewContainer();\n    ArchiveListView.__super__.constructor.call(this, options);\n  }\n\n  ArchiveListView.prototype.setTags = function(tags) {\n    var _this = this;\n\n    this.selectedTags = tags;\n    if (this.collection != null) {\n      this.stopListening(this.collection);\n      delete this.collection;\n    }\n    this.collection = this.baseCollection.getByTags(this.selectedTags);\n    this.listenTo(this.collection, 'add', this.render);\n    this.listenTo(this.collection, 'remove', this.render);\n    return this.listenTo(this.collection, 'change', function(task) {\n      var taskView;\n\n      if (!(task != null ? task.get('isArchived') : void 0)) {\n        taskView = _this.views.findByModel(task);\n        return taskView.$el.fadeOut(function() {\n          _this.stopListening(taskView);\n          _this.views.remove(taskView);\n          taskView.destroy();\n          return _this.trigger('restore-task', task);\n        });\n      }\n    });\n  };\n\n  ArchiveListView.prototype.getRenderData = function() {\n    return {\n      title: this.getTitle()\n    };\n  };\n\n  ArchiveListView.prototype.beforeRender = function() {\n    var _this = this;\n\n    return this.views.forEach(function(taskView) {\n      if (_this.collection.indexOf(taskView.model) !== -1) {\n        return taskView.$el.detach();\n      } else {\n        _this.stopListening(taskView);\n        _this.views.remove(taskView);\n        return taskView.destroy();\n      }\n    });\n  };\n\n  ArchiveListView.prototype.afterRender = function() {\n    var _this = this;\n\n    this.collection.forEach(function(task) {\n      var taskView;\n\n      taskView = _this.views.findByModel(task);\n      if (taskView == null) {\n        taskView = new ArchiveTaskView({\n          model: task\n        });\n        _this.views.add(taskView);\n      } else {\n        taskView.delegateEvents();\n      }\n      return $(_this.collectionEl).append(taskView.render().$el);\n    });\n    return this.$el;\n  };\n\n  ArchiveListView.prototype.getTitle = function() {\n    var tagsList;\n\n    if (this.collection.length === this.baseCollection.length) {\n      return t('all archived tasks');\n    } else {\n      tagsList = Utils.buildTagsList(this.selectedTags, {\n        tagPrefix: '#',\n        regularSeparator: ', ',\n        lastSeparator: \" \" + (t('and')) + \" \"\n      });\n      return t('archived tasks of', {\n        tagsList: tagsList,\n        smart_count: this.selectedTags.length\n      });\n    }\n  };\n\n  return ArchiveListView;\n\n})(BaseView);\n","var ArchiveTaskView, TaskView, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nTaskView = require('./task_view');\n\nmodule.exports = ArchiveTaskView = (function(_super) {\n  __extends(ArchiveTaskView, _super);\n\n  function ArchiveTaskView() {\n    _ref = ArchiveTaskView.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  ArchiveTaskView.prototype.tagName = 'li';\n\n  ArchiveTaskView.prototype.className = 'task archive done';\n\n  ArchiveTaskView.prototype.template = require('./templates/task_archive');\n\n  ArchiveTaskView.prototype.getRenderData = function() {\n    var date;\n\n    date = Date.create(this.model.get('completionDate'));\n    return _.extend(ArchiveTaskView.__super__.getRenderData.call(this), {\n      competionDate: date.format(t('archived date format'))\n    });\n  };\n\n  ArchiveTaskView.prototype.afterRender = function() {};\n\n  ArchiveTaskView.prototype.onClick = function() {\n    this.model.set('done', false);\n    this.model.set('completionDate', null);\n    this.model.set('isArchived', false);\n    this.model.save();\n    return this.render();\n  };\n\n  ArchiveTaskView.prototype.onMouseEnter = function() {\n    var button;\n\n    button = this.$('button');\n    if (this.model.get('done')) {\n      button.prop('title', t('restore button?'));\n      return button.html(t('restore button?'));\n    }\n  };\n\n  ArchiveTaskView.prototype.onMouseLeave = function() {\n    var button;\n\n    button = this.$('button');\n    if (this.model.get('done')) {\n      return button.html(t('done button'));\n    }\n  };\n\n  return ArchiveTaskView;\n\n})(TaskView);\n","var BaseView, MenuItemView, TagsCollection,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('../lib/base_view');\n\nTagsCollection = require('../collections/tags');\n\nmodule.exports = MenuItemView = (function(_super) {\n  __extends(MenuItemView, _super);\n\n  MenuItemView.prototype.tagName = 'li';\n\n  MenuItemView.prototype.className = 'menu-tag';\n\n  MenuItemView.prototype.template = require('./templates/menu_item');\n\n  MenuItemView.prototype.collectionEl = 'ul.submenu';\n\n  MenuItemView.prototype.views = null;\n\n  MenuItemView.prototype.events = {\n    'click': 'onClick'\n  };\n\n  function MenuItemView(options) {\n    this.baseCollection = options.baseCollection;\n    this.archivedCollection = options.archivedCollection;\n    this.selectedTags = options.selectedTags;\n    this.depth = options.depth;\n    this.viewType = options.viewType;\n    this.views = new Backbone.ChildViewContainer();\n    MenuItemView.__super__.constructor.call(this, options);\n  }\n\n  MenuItemView.prototype.getRenderData = function() {\n    var params;\n\n    params = MenuItemView.__super__.getRenderData.call(this);\n    _.extend(params, {\n      url: this.buildUrl()\n    });\n    return params;\n  };\n\n  MenuItemView.prototype.buildUrl = function() {\n    var currentIndex, prefix, tagsInUrl, url, _ref, _ref1, _ref2, _ref3;\n\n    tagsInUrl = ((_ref = this.selectedTags) != null ? _ref.slice(0, this.depth) : void 0) || [];\n    currentIndex = (_ref1 = this.selectedTags) != null ? _ref1.indexOf(this.model.get('tagName')) : void 0;\n    if ((!_.contains(tagsInUrl, this.model.get('tagName')) || ((_ref2 = this.selectedTags) != null ? _ref2.length : void 0) > this.depth + 1) && (!(currentIndex + 1 === ((_ref3 = this.selectedTags) != null ? _ref3.length : void 0) && this.depth === currentIndex))) {\n      tagsInUrl.push(this.model.get('tagName'));\n    }\n    if (this.viewType === \"#tobedone\") {\n      url = \"#\";\n      prefix = 'todoByTags';\n    } else {\n      url = \"#archived\";\n      prefix = 'archivedByTags';\n    }\n    if (tagsInUrl.length > 0) {\n      url = \"#\" + prefix;\n      tagsInUrl.forEach(function(item) {\n        return url = \"\" + url + \"/\" + item;\n      });\n    }\n    return url;\n  };\n\n  MenuItemView.prototype.beforeRender = function() {\n    if (this.model.get('isMagic')) {\n      return this.$el.addClass('magic');\n    }\n  };\n\n  MenuItemView.prototype.afterRender = function() {\n    var currentIndex, leftPadding, tags, _ref,\n      _this = this;\n\n    currentIndex = (_ref = this.selectedTags) != null ? _ref.indexOf(this.model.get('tagName')) : void 0;\n    if (currentIndex === this.depth) {\n      this.$el.addClass('active');\n      if (this.depth + 1 === this.selectedTags.length) {\n        this.$el.addClass('selected');\n      }\n    }\n    leftPadding = (this.depth + 1) * 25;\n    this.$('a').css('padding-left', leftPadding);\n    if ((this.selectedTags != null) && this.selectedTags[this.depth] === this.model.get('tagName')) {\n      tags = this.buildTagsList();\n      return tags.forEach(function(tagInfo) {\n        var menuItem;\n\n        menuItem = new MenuItemView({\n          model: new Backbone.Model({\n            tagName: tagInfo.get('id'),\n            count: tagInfo.get('count')\n          }),\n          selectedTags: _this.selectedTags,\n          depth: _this.depth + 1,\n          viewType: _this.viewType,\n          baseCollection: _this.baseCollection,\n          archivedCollection: _this.archivedCollection\n        });\n        _this.views.add(menuItem);\n        return _this.$el.children(_this.collectionEl).append(menuItem.render().$el);\n      });\n    }\n  };\n\n  MenuItemView.prototype.buildTagsList = function() {\n    var collection, excludedItems, includedTags, tagsList;\n\n    excludedItems = this.selectedTags || [];\n    excludedItems = excludedItems.slice(0, this.depth + 1);\n    includedTags = this.selectedTags || [];\n    includedTags = includedTags.slice(0, this.depth + 1);\n    if (this.collection != null) {\n      delete this.collection;\n    }\n    if (this.viewType === \"#tobedone\") {\n      collection = this.baseCollection;\n    } else {\n      collection = this.archivedCollection;\n    }\n    this.collection = collection.getByTags(includedTags);\n    tagsList = TagsCollection.extractFromTasks(this.collection, excludedItems, this.selectedTags);\n    return tagsList;\n  };\n\n  return MenuItemView;\n\n})(BaseView);\n","var BaseView, MenuItemView, MenuView,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('../lib/base_view');\n\nMenuItemView = require('./menu_item_view');\n\nmodule.exports = MenuView = (function(_super) {\n  __extends(MenuView, _super);\n\n  MenuView.prototype.el = '#menu';\n\n  MenuView.prototype.template = require('./templates/menu');\n\n  MenuView.prototype.views = null;\n\n  MenuView.prototype.collectionEl = 'ul.tags';\n\n  MenuView.prototype.activeTags = null;\n\n  MenuView.prototype.subMenuHandler = null;\n\n  function MenuView(options) {\n    this.baseCollection = options.baseCollection;\n    this.archivedCollection = options.archivedCollection;\n    this.views = new Backbone.ChildViewContainer();\n    MenuView.__super__.constructor.call(this, options);\n  }\n\n  MenuView.prototype.initialize = function(options) {\n    this.listenTo(this.baseCollection, {\n      'add': this.onChange,\n      'change': this.onChange,\n      'remove': this.onChange\n    });\n    this.listenTo(this.archivedCollection, {\n      'add': this.onChange,\n      'change': this.onChange,\n      'remove': this.onChange\n    });\n    return MenuView.__super__.initialize.call(this, options);\n  };\n\n  MenuView.prototype.getRenderData = function() {\n    var archivedCount;\n\n    if (this.archivedCollection.length > 1000) {\n      archivedCount = 'Over 9000++';\n    } else {\n      archivedCount = this.archivedCollection.length;\n    }\n    return {\n      allCount: this.baseCollection.length,\n      untaggedCount: this.baseCollection.filter(function(task) {\n        return task.get('tags').length === 0;\n      }).length,\n      archivedCount: archivedCount\n    };\n  };\n\n  MenuView.prototype.beforeRender = function() {\n    var tagsList,\n      _this = this;\n\n    tagsList = this.baseCollection.getAllTags();\n    return this.views.forEach(function(taskView) {\n      if (tagsList.indexOf(taskView.model.get('tagName')) !== -1) {\n        return taskView.$el.detach();\n      } else {\n        _this.stopListening(taskView);\n        _this.views.remove(taskView);\n        return taskView.destroy();\n      }\n    });\n  };\n\n  MenuView.prototype.afterRender = function() {\n    var archivedListEl, isActive, prefix, submenuEl, tags, template, typeViewEl, untaggedNum, untaggedView, untaggedViewContent, _ref,\n      _this = this;\n\n    typeViewEl = this.$(\"\" + this.viewType);\n    submenuEl = this.$(\"\" + this.viewType + \" > .submenu\");\n    if (this.viewType === \"#tobedone\") {\n      this.collection = this.baseCollection;\n    } else {\n      this.collection = this.archivedCollection;\n    }\n    untaggedNum = this.collection.filter(function(task) {\n      return task.get('tags').length === 0;\n    }).length;\n    if (untaggedNum > 0) {\n      template = require('./templates/menu_item');\n      if (this.viewType === \"#tobedone\") {\n        prefix = 'todoByTags';\n      } else {\n        prefix = 'archivedByTags';\n      }\n      isActive = ((_ref = this.activeTags) != null ? _ref.length : void 0) === 0 ? \" active selected\" : \"\";\n      untaggedView = $('<li class=\"menu-tag magic' + isActive + '\"></li>');\n      untaggedViewContent = template({\n        url: \"#\" + prefix + \"/\",\n        model: {\n          tagName: t('untagged'),\n          count: untaggedNum\n        }\n      });\n      untaggedView.append(untaggedViewContent);\n      submenuEl.append(untaggedView);\n    }\n    if (this.viewType === \"#tobedone\") {\n      archivedListEl = this.$('#archived');\n      this.$('ul:first-child').prepend(archivedListEl);\n    }\n    tags = this.collection.getAllTags();\n    tags.forEach(function(tagInfo) {\n      var menuItem;\n\n      menuItem = new MenuItemView({\n        model: new Backbone.Model({\n          tagName: tagInfo.get('id'),\n          count: tagInfo.get('count'),\n          isMagic: tagInfo.get('isMagic')\n        }),\n        selectedTags: _this.activeTags,\n        depth: 0,\n        viewType: _this.viewType,\n        baseCollection: _this.baseCollection,\n        archivedCollection: _this.archivedCollection\n      });\n      _this.views.add(menuItem);\n      return submenuEl.append(menuItem.render().$el);\n    });\n    typeViewEl.addClass('active');\n    if (this.activeTags == null) {\n      typeViewEl.addClass('selected');\n    }\n    return this.$el;\n  };\n\n  MenuView.prototype.onChange = function() {\n    return this.render();\n  };\n\n  MenuView.prototype.setActive = function(tags) {\n    return this.activeTags = tags;\n  };\n\n  MenuView.prototype.setViewType = function(viewType) {\n    return this.viewType = viewType;\n  };\n\n  return MenuView;\n\n})(BaseView);\n","var BaseView, TaskFormView, TaskView, Utils, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nBaseView = require('../lib/base_view');\n\nUtils = require('../lib/utils');\n\nTaskView = require('./task_view');\n\nmodule.exports = TaskFormView = (function(_super) {\n  __extends(TaskFormView, _super);\n\n  function TaskFormView() {\n    _ref = TaskFormView.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  TaskFormView.prototype.el = '#new-task';\n\n  TaskFormView.prototype.template = require('./templates/task_form');\n\n  TaskFormView.prototype.events = {\n    'keydown input': 'onKeydown',\n    'keyup input': 'onKeyup',\n    'blur input': 'onSubmit',\n    'click button': 'onSubmit'\n  };\n\n  TaskFormView.prototype.initialize = function(options) {\n    TaskFormView.__super__.initialize.call(this);\n    return this.tags = options.tags;\n  };\n\n  TaskFormView.prototype.onKeydown = function(event) {\n    var authorizedComboKeys, inputVal, key, neutralKeys, tagsList;\n\n    key = event.keyCode || event.charCode;\n    inputVal = this.$('input').val();\n    tagsList = Utils.buildTagsList(this.tags, {\n      tagPrefix: '#'\n    });\n    if (tagsList !== \"\") {\n      tagsList = \"\" + tagsList + \" \";\n    }\n    neutralKeys = [8, 32, 9, 13, 38, 40, 37, 39];\n    authorizedComboKeys = [220, 86];\n    if (inputVal.length === 0 && __indexOf.call(neutralKeys, key) < 0 && (!(event.metaKey || event.ctrlKey || event.altKey) || __indexOf.call(authorizedComboKeys, key) >= 0)) {\n      this.$('input').val(tagsList);\n      return inputVal = tagsList;\n    }\n  };\n\n  TaskFormView.prototype.onKeyup = function(event) {\n    var inputVal, key;\n\n    key = event.keyCode || event.charCode;\n    inputVal = this.$('input').val();\n    if (inputVal.length === 0) {\n      this.$('button').addClass('disabled');\n    } else {\n      this.$('button').removeClass('disabled');\n    }\n    if (key === 13) {\n      this.onSubmit();\n    }\n    if (key === 40) {\n      return this.trigger('focus-down');\n    }\n  };\n\n  TaskFormView.prototype.onSubmit = function() {\n    var inputVal;\n\n    inputVal = this.$('input').val();\n    if (inputVal.length > 0) {\n      return this.trigger('new-task-submitted', {\n        content: inputVal\n      });\n    }\n  };\n\n  TaskFormView.prototype.getRenderData = function() {\n    return {\n      formPlaceholder: this.getFormPlaceholder()\n    };\n  };\n\n  TaskFormView.prototype.getFormPlaceholder = function() {\n    var tagsList;\n\n    tagsList = Utils.buildTagsList(this.tags, {\n      tagPrefix: '#',\n      regularSeparator: ', ',\n      lastSeparator: \" \" + (t('and')) + \" \"\n    });\n    if (tagsList.length > 0) {\n      return t('form headline tags', {\n        tagsList: tagsList\n      });\n    } else {\n      return t('form headline');\n    }\n  };\n\n  return TaskFormView;\n\n})(BaseView);\n","var BaseView, Task, TaskFormView, TaskListView, TaskView, Utils,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('../lib/base_view');\n\nUtils = require('../lib/utils');\n\nTask = require('../models/task');\n\nTaskView = require('./task_view');\n\nTaskFormView = require('./task_form_view');\n\nmodule.exports = TaskListView = (function(_super) {\n  __extends(TaskListView, _super);\n\n  TaskListView.prototype.el = '.container';\n\n  TaskListView.prototype.template = require('./templates/task_list');\n\n  TaskListView.prototype.views = null;\n\n  TaskListView.prototype.collectionEl = 'ul#task-list';\n\n  TaskListView.prototype.isReindexing = false;\n\n  TaskListView.prototype.events = {\n    'click #archive-action': 'onArchiveClicked',\n    'click h1': 'reindex'\n  };\n\n  TaskListView.prototype.reindex = function() {\n    return this.baseCollection.reindex();\n  };\n\n  function TaskListView(options) {\n    this.baseCollection = options.baseCollection;\n    this.views = new Backbone.ChildViewContainer();\n    TaskListView.__super__.constructor.call(this, options);\n  }\n\n  TaskListView.prototype.initialize = function() {\n    this.listenTo(this.baseCollection, 'reindexing', function() {\n      this.isReindexing = true;\n      $('#block').show();\n      return $('#modal').show();\n    });\n    return this.listenTo(this.baseCollection, 'reindexed', function(error) {\n      this.isReindexing = false;\n      $('#block').hide();\n      $('#modal').hide();\n      if (error != null) {\n        return console.log(error);\n      }\n    });\n  };\n\n  TaskListView.prototype.setTags = function(tags) {\n    var _this = this;\n\n    this.selectedTags = tags;\n    if (this.collection != null) {\n      this.stopListening(this.collection);\n      delete this.collection;\n    }\n    this.collection = this.baseCollection.getByTags(this.selectedTags);\n    this.listenTo(this.collection, 'add', this.render);\n    this.listenTo(this.collection, 'remove', function(task) {\n      var previousVisibleTask;\n\n      previousVisibleTask = task.getPreviousWithTags(_this.selectedTags);\n      if (previousVisibleTask != null) {\n        _this.taskModelCIDToFocus = previousVisibleTask.cid;\n      }\n      return _this.render();\n    });\n    return this.listenTo(this.collection, 'change', function(task) {\n      return _this.updateArchiveButtonState();\n    });\n  };\n\n  TaskListView.prototype.getRenderData = function() {\n    return {\n      title: this.getTitle()\n    };\n  };\n\n  TaskListView.prototype.beforeRender = function() {\n    var _this = this;\n\n    return this.views.forEach(function(taskView) {\n      if (_this.collection.indexOf(taskView.model) !== -1) {\n        return taskView.$el.detach();\n      } else {\n        _this.stopListening(taskView);\n        _this.views.remove(taskView);\n        return taskView.destroy();\n      }\n    });\n  };\n\n  TaskListView.prototype.afterRender = function() {\n    var view,\n      _this = this;\n\n    this.updateArchiveButtonState();\n    if (this.taskForm != null) {\n      this.stopListening(this.taskForm);\n      this.taskForm.destroy();\n    }\n    this.taskForm = new TaskFormView({\n      tags: this.selectedTags\n    });\n    this.listenTo(this.taskForm, 'new-task-submitted', this.createNewTask);\n    this.listenTo(this.taskForm, 'focus-down', this.onFocusDown);\n    this.taskForm.render();\n    this.collection.forEach(function(task) {\n      var taskView;\n\n      taskView = _this.views.findByModel(task);\n      if (taskView == null) {\n        taskView = new TaskView({\n          model: task\n        });\n        _this.views.add(taskView);\n        _this.listenTo(taskView, 'new-task-submitted', _this.createNewTask);\n        _this.listenTo(taskView, 'focus-up', _this.onFocusUp);\n        _this.listenTo(taskView, 'focus-down', _this.onFocusDown);\n        _this.listenTo(taskView, 'move-up', _this.onMoveUp);\n        _this.listenTo(taskView, 'move-down', _this.onMoveDown);\n      } else {\n        taskView.delegateEvents();\n      }\n      return $(_this.collectionEl).append(taskView.render().$el);\n    });\n    if (this.taskModelCIDToFocus != null) {\n      view = this.views.findByModelCid(this.taskModelCIDToFocus);\n      if (view != null) {\n        view.setFocus();\n      } else {\n        console.log(\"something went wrong trying to focus\");\n        this.taskForm.$el.find('input').focus();\n      }\n      this.taskModelCIDToFocus = null;\n    } else {\n      this.taskForm.$el.find('input').focus();\n    }\n    return this.$el;\n  };\n\n  TaskListView.prototype.getTitle = function() {\n    var tagsList;\n\n    if (this.collection.length === this.baseCollection.length) {\n      return t('all tasks');\n    } else if ((this.selectedTags != null) && this.selectedTags.length === 0) {\n      return t('untagged tasks');\n    } else {\n      tagsList = Utils.buildTagsList(this.selectedTags, {\n        tagPrefix: '#',\n        regularSeparator: ', ',\n        lastSeparator: \" \" + (t('and')) + \" \"\n      });\n      return t('tasks of', {\n        tagsList: tagsList,\n        smart_count: this.selectedTags.length\n      });\n    }\n  };\n\n  TaskListView.prototype.createNewTask = function(options) {\n    var content, index, newNext, nextIndex, order, previous, step, tagsList, task, _ref;\n\n    if (options == null) {\n      options = {};\n    }\n    if (this.isReindexing) {\n      return;\n    }\n    tagsList = Utils.buildTagsList(this.selectedTags, {\n      tagPrefix: '#'\n    });\n    if (tagsList !== \"\") {\n      tagsList = \"\" + tagsList + \" \";\n    }\n    content = options.content || tagsList;\n    if (options.previous != null) {\n      previous = this.views.findByModelCid(options.previous).model;\n      nextIndex = this.baseCollection.indexOf(previous) + 1;\n      newNext = this.baseCollection.at(nextIndex);\n      order = this.baseCollection.getNewOrder(previous, newNext);\n      index = nextIndex;\n    } else {\n      newNext = this.baseCollection.at(0);\n      _ref = this.baseCollection.getNewOrder(null, newNext), order = _ref.order, step = _ref.step;\n      index = 0;\n    }\n    task = new Task({\n      description: content,\n      order: order,\n      tags: Task.extractTags(content)\n    });\n    this.taskModelCIDToFocus = options.previous != null ? task.cid : null;\n    this.baseCollection.create(task, {\n      at: index\n    });\n    return this.checkIfReindexationIsNeeded(step);\n  };\n\n  TaskListView.prototype.onFocusUp = function(cid) {\n    var currentModel, previousIndex, previousModel;\n\n    currentModel = this.views.findByModelCid(cid).model;\n    previousIndex = this.collection.indexOf(currentModel) - 1;\n    previousModel = this.collection.at(previousIndex);\n    if (previousIndex >= 0) {\n      return this.views.findByModel(previousModel).setFocus();\n    } else {\n      return this.taskForm.$el.find('input').focus();\n    }\n  };\n\n  TaskListView.prototype.onFocusDown = function(cid) {\n    var currentModel, nextIndex, nextModel;\n\n    if (cid != null) {\n      currentModel = this.views.findByModelCid(cid).model;\n      nextIndex = this.collection.indexOf(currentModel) + 1;\n      nextModel = this.collection.at(nextIndex);\n    } else {\n      nextIndex = 0;\n      nextModel = this.collection.at(nextIndex);\n    }\n    if (nextIndex < this.views.length) {\n      return this.views.findByModel(nextModel).setFocus();\n    }\n  };\n\n  TaskListView.prototype.onMoveUp = function(cid, toFocus) {\n    var currentModel, newOrder, order, previous, previousIndex, previousOfPrevious, step;\n\n    if (toFocus == null) {\n      toFocus = null;\n    }\n    if (this.isReindexing) {\n      return;\n    }\n    currentModel = this.views.findByModelCid(cid).model;\n    previousIndex = this.baseCollection.indexOf(currentModel) - 1;\n    previous = this.baseCollection.at(previousIndex);\n    previousOfPrevious = this.baseCollection.at(previousIndex - 1) || null;\n    if (previousIndex >= 0) {\n      newOrder = this.baseCollection.getNewOrder(previousOfPrevious, previous);\n      order = newOrder.order, step = newOrder.step;\n      task.set('order', order);\n      task.save();\n      this.baseCollection.sort();\n      this.taskModelCIDToFocus = toFocus != null ? toFocus : cid;\n      this.render();\n      return this.checkIfReindexationIsNeeded(step);\n    }\n  };\n\n  TaskListView.prototype.onMoveDown = function(cid) {\n    var currentModel, newOrder, nextIndex, nextModel, nextOfNextModel, order, step;\n\n    if (this.isReindexing) {\n      return;\n    }\n    currentModel = this.views.findByModelCid(cid).model;\n    nextIndex = this.baseCollection.indexOf(currentModel) + 1;\n    nextModel = this.baseCollection.at(nextIndex);\n    nextOfNextModel = this.baseCollection.at(nextIndex + 1) || null;\n    if (nextIndex !== this.baseCollection.length) {\n      newOrder = this.baseCollection.getNewOrder(nextModel, nextOfNextModel);\n      order = newOrder.order, step = newOrder.step;\n      task.set('order', order);\n      task.save();\n      this.baseCollection.sort();\n      this.taskModelCIDToFocus = typeof toFocus !== \"undefined\" && toFocus !== null ? toFocus : cid;\n      this.render();\n      return this.checkIfReindexationIsNeeded(step);\n    }\n  };\n\n  TaskListView.prototype.updateArchiveButtonState = function() {\n    if (this.collection.where({\n      done: true\n    }).length > 0) {\n      return this.$('#archive-action').removeClass('disable');\n    } else {\n      return this.$('#archive-action').addClass('disable');\n    }\n  };\n\n  TaskListView.prototype.onArchiveClicked = function() {\n    var counterArchived, counterToArchive, done, tasksToArchive,\n      _this = this;\n\n    if (this.isReindexing) {\n      return;\n    }\n    tasksToArchive = this.collection.where({\n      done: true\n    });\n    counterToArchive = tasksToArchive.length;\n    counterArchived = 0;\n    if (counterToArchive > 0) {\n      this.$('#archive-action').html('&nbsp;');\n      this.$('#archive-action').spin('tiny', '#fff');\n    }\n    done = function(task) {\n      var taskView;\n\n      counterArchived++;\n      taskView = _this.views.findByModel(task);\n      if (counterArchived === counterToArchive) {\n        _this.stopListening(taskView);\n        _this.views.remove(taskView);\n        return taskView.$el.fadeOut(function() {\n          taskView.destroy();\n          _this.$('#archive-action').html(t('archive button'));\n          return _this.trigger('archive-tasks', tasksToArchive);\n        });\n      } else {\n        _this.stopListening(taskView);\n        _this.views.remove(taskView);\n        return taskView.$el.fadeOut(function() {\n          return taskView.destroy();\n        });\n      }\n    };\n    return tasksToArchive.forEach(function(task) {\n      task.set('isArchived', true);\n      task.once('sync', done);\n      return task.save();\n    });\n  };\n\n  TaskListView.prototype.checkIfReindexationIsNeeded = function(step) {\n    var maxThreshold, threshold;\n\n    threshold = Math.pow(10, 8);\n    maxThreshold = Number.MAX_VALUE / (this.baseCollection.length + 1);\n    if (maxThreshold < threshold) {\n      threshold = maxThreshold;\n    }\n    if (step <= threshold) {\n      return this.baseCollection.reindex();\n    }\n  };\n\n  return TaskListView;\n\n})(BaseView);\n","var BaseView, TaskView, _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('../lib/base_view');\n\nmodule.exports = TaskView = (function(_super) {\n  __extends(TaskView, _super);\n\n  function TaskView() {\n    _ref = TaskView.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  TaskView.prototype.tagName = 'li';\n\n  TaskView.prototype.className = 'task';\n\n  TaskView.prototype.template = require('./templates/task');\n\n  TaskView.prototype.events = {\n    'keydown  input': 'onKeydown',\n    'keyup  input': 'onKeyup',\n    'focus input': 'onFocus',\n    'blur input': 'onBlur',\n    'click button': 'onClick',\n    'mouseenter button': 'onMouseEnter',\n    'mouseleave button': 'onMouseLeave'\n  };\n\n  TaskView.prototype.getRenderData = function() {\n    return {\n      model: this.model.toJSON(),\n      tabindex: this.model.collection.indexOf(this.model) + 2\n    };\n  };\n\n  TaskView.prototype.afterRender = function() {\n    if (this.model.get('done')) {\n      this.$el.addClass('done');\n      return this.$('button').html(t('done button'));\n    } else {\n      return this.$el.removeClass('done');\n    }\n  };\n\n  TaskView.prototype.onClick = function() {\n    this.model.set('done', !this.model.get('done'));\n    if (this.model.get('done')) {\n      this.model.set('completionDate', Date.now());\n    } else {\n      this.model.set('completionDate', null);\n    }\n    this.afterRender();\n    this.model.save();\n    return this.render();\n  };\n\n  TaskView.prototype.onKeydown = function(event) {\n    var ctrlPressed, key;\n\n    key = event.keyCode || event.charCode;\n    ctrlPressed = event.controlKey || event.metaKey;\n    if (this.$('input').val() === \"\" && key === 8) {\n      this.model.destroy();\n      return event.preventDefault();\n    } else if (key === 38 && ctrlPressed) {\n      return this.trigger('move-up', this.model.cid);\n    } else if (key === 40 && ctrlPressed) {\n      return this.trigger('move-down', this.model.cid);\n    }\n  };\n\n  TaskView.prototype.onKeyup = function(event) {\n    var key;\n\n    key = event.keyCode || event.charCode;\n    if (key === 13) {\n      this.onBlur();\n      return this.trigger('new-task-submitted', {\n        content: '',\n        previous: this.model.cid\n      });\n    } else if (key === 38) {\n      return this.trigger('focus-up', this.model.cid);\n    } else if (key === 40) {\n      return this.trigger('focus-down', this.model.cid);\n    }\n  };\n\n  TaskView.prototype.onFocus = function() {\n    var _this = this;\n\n    return this.focusInterval = setInterval(function() {\n      return _this.saveDescription();\n    }, 2000);\n  };\n\n  TaskView.prototype.onBlur = function() {\n    clearInterval(this.focusInterval);\n    return this.saveDescription();\n  };\n\n  TaskView.prototype.saveDescription = function() {\n    var description;\n\n    description = this.$('input').val();\n    if (description !== this.model.get('description')) {\n      this.model.set('description', description);\n      return this.model.save();\n    }\n  };\n\n  TaskView.prototype.setFocus = function() {\n    var index, inputField;\n\n    inputField = this.$('input');\n    inputField.focus();\n    index = inputField.val().length;\n    return inputField[0].setSelectionRange(index, index);\n  };\n\n  TaskView.prototype.onMouseEnter = function() {\n    var button;\n\n    button = this.$('button');\n    if (this.model.get('done')) {\n      button.attr('title', t('todo button?'));\n      return button.html(t('todo button?'));\n    } else {\n      button.attr('title', t('done button?'));\n      return button.html(t('done button?'));\n    }\n  };\n\n  TaskView.prototype.onMouseLeave = function() {\n    var button;\n\n    button = this.$('button');\n    if (this.model.get('done')) {\n      return button.html(t('done button'));\n    } else {\n      return button.html(t('todo button'));\n    }\n  };\n\n  TaskView.prototype.destroy = function() {\n    clearTimeout(this.focusInterval);\n    return TaskView.__super__.destroy.call(this);\n  };\n\n  return TaskView;\n\n})(BaseView);\n","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div id=\"menu\"></div><div class=\"container\"></div><div id=\"block\"></div><div id=\"modal\"><p>');\nvar __val__ = t('reindexing message')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<ul><li id=\"tobedone\" class=\"first-level\"><a href=\"#\">' + escape((interp = t('todo')) == null ? '' : interp) + ' (' + escape((interp = allCount) == null ? '' : interp) + ')</a><ul class=\"submenu\"></ul></li><li id=\"archived\" class=\"first-level\"><a href=\"#archived\">' + escape((interp = t('archived')) == null ? '' : interp) + ' (' + escape((interp = archivedCount) == null ? '' : interp) + ')</a><ul class=\"submenu\"></ul></li></ul>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<a');\nbuf.push(attrs({ 'href':(\"\" + (url) + \"\"), 'title':(\"\" + (model.tagName) + \"\") }, {\"href\":true,\"title\":true}));\nbuf.push('><i class=\"tag-icon\"></i><span>' + escape((interp = model.tagName) == null ? '' : interp) + ' (' + escape((interp = model.count) == null ? '' : interp) + ')</span></a><ul class=\"submenu\"></ul>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"task-container\"><button title=\"t(\\'todo button\\')\" class=\"toggle-state button\">');\nvar __val__ = t('todo button')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</button><div class=\"todo-field\"><input');\nbuf.push(attrs({ 'value':(\"\" + (model.description) + \"\"), 'tabindex':(\"\" + (tabindex) + \"\") }, {\"value\":true,\"tabindex\":true}));\nbuf.push('/></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"task-container\"><button');\nbuf.push(attrs({ 'title':(\"\" + (t('done button')) + \"\"), \"class\": ('toggle-state') + ' ' + ('button') }, {\"title\":true}));\nbuf.push('>');\nvar __val__ = t('done button')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</button><div class=\"todo-field\"><input');\nbuf.push(attrs({ 'value':(\"\" + (model.description) + \"\"), 'tabindex':(\"\" + (tabindex) + \"\") }, {\"value\":true,\"tabindex\":true}));\nbuf.push('/></div></div><div class=\"todo-completionDate\"><p>' + escape((interp = t('completed headline')) == null ? '' : interp) + ' ' + escape((interp = competionDate) == null ? '' : interp) + '</p></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"task-container\"><button class=\"toggle-state button disabled\">');\nvar __val__ = t('new button')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</button><div class=\"todo-field\"><input');\nbuf.push(attrs({ 'tabindex':(\"1\"), 'placeholder':(\"\" + (formPlaceholder) + \"\") }, {\"tabindex\":true,\"placeholder\":true}));\nbuf.push('/></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<h1>' + escape((interp = title) == null ? '' : interp) + '</h1><p id=\"actions\">' + escape((interp = t('actions headline')) == null ? '' : interp) + ':<button id=\"archive-action\" class=\"button disable\">');\nvar __val__ = t('archive button')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</button></p><div id=\"new-task\" class=\"task\"></div><ul id=\"task-list\"></ul>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<h1>' + escape((interp = title) == null ? '' : interp) + '</h1><ul id=\"task-list\"></ul>');\n}\nreturn buf.join(\"\");\n};"]}